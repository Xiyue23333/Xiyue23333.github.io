<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>第三节·第三点：制作第一个方块（方块注册与资源文件） | Minecraft Mod Create</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@500;700&family=Noto+Sans+SC:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles/main.css">
</head>
<body>
  <header class="site-header">
    <a class="brand js-sidebar-toggle" href="#" aria-controls="site-drawer" aria-expanded="false">
      <span class="brand-menu" aria-hidden="true"><span></span><span></span><span></span></span>
      <span>Minecraft Mod Create</span>
    </a>
    <nav>
      <a href="../index.html#updates">最新更新</a>
      <a href="chapter-select.html">章节选择</a>
      <a href="../index.html#messages">留言区</a>
      <a href="shader-lab.html">Shader 实验室</a>
      <a class="nav-cta" href="chapter-select.html">开始学习</a>
    </nav>
  </header>

  <div class="drawer-overlay" data-drawer-overlay hidden></div>
  <aside class="site-drawer" id="site-drawer" aria-hidden="true">
    <a class="drawer-home" href="../index.html">← 回到首页</a>

    <div class="site-drawer-head">
      <h2>快捷跳转</h2>
      <button class="drawer-close" type="button" data-drawer-close aria-label="关闭侧边栏">x</button>
    </div>

    <p class="site-drawer-text">点击章节可展开并跳转到对应页面。</p>

    <div class="drawer-groups">
      <section class="drawer-group">
        <button class="drawer-group-toggle root-toggle" type="button" data-drawer-group-toggle data-target="drawer-ch1-list" aria-expanded="false">
          <span>第一章：初窥门径</span>
          <span class="drawer-caret" aria-hidden="true">▾</span>
        </button>
        <nav class="drawer-group-list" id="drawer-ch1-list">
          <a href="chapter-1-intro.html">章节总览</a>
          <a href="ch1-sec1-environment-setup.html">第一节：开发环境构建</a>
          <a href="ch1-sec2-read-official-code.html">第二节：学会查看官方代码</a>
          <button class="drawer-group-toggle drawer-sub-toggle" type="button" data-drawer-group-toggle data-target="drawer-ch1-sec3-list" aria-expanded="false">
            <span>第三节：开始制作自己的 Mod</span>
            <span class="drawer-caret" aria-hidden="true">▾</span>
          </button>
          <nav class="drawer-group-list drawer-sub-list" id="drawer-ch1-sec3-list">
            <a href="ch1-sec3-point1-first-item.html">第三节-1：第一个物品</a>
            <a href="ch1-sec3-point2-creative-tab.html">第三节-2：创造模式物品栏</a>
            <a href="ch1-sec3-point3-resources-structure.html">第三节-3：制作第一个方块</a>
          </nav>
          <a href="ch1-sec3-start-your-mod.html">进入第三节总览</a>
        </nav>
      </section>
    </div>
  </aside>

  <main class="guide-main guide-main-wide">
    <a class="breadcrumb" href="ch1-sec3-start-your-mod.html">← 返回上一页</a>

    <header class="guide-hero">
      <p class="eyebrow">CHAPTER 01 · SECTION 03 · POINT 03</p>
      <h1>第三节·第三点：制作第一个方块（方块注册与资源文件）</h1>
      <div class="meta">
        <span>状态：完整教程</span>
        <span>来源：E:\教程mod</span>
      </div>
    </header>

    <section class="section">
      <h2>本节目标</h2>
      <ul class="step-list">
        <li>注册一个方块（示例：<code>crystal_block</code> 水晶块）。</li>
        <li>正确注册方块对应的方块物品（<code>BlockItem</code>），让玩家能在背包/创造模式中拿到它。</li>
        <li>补齐方块资源文件：<code>blockstates</code> / <code>models</code> / <code>textures</code> / 语言文件。</li>
      </ul>
    </section>

    <section class="section">
      <h2>第一步：创建方块注册类 <code>ModBlocks</code></h2>
      <p>继续使用前面约定的文件分类：<code>common/registry</code> 专门放注册类。</p>
      <p>创建：</p>
      <p><code>src/main/java/com/xiyue/tutorial/common/registry/ModBlocks.java</code></p>
      <p>然后用 <code>DeferredRegister&lt;Block&gt;</code> 注册你的方块。</p>
    </section>

    <section class="section">
      <h2>第二步：方块物品（BlockItem）注册（重点讲清楚）</h2>
      <p>很多新手会遇到“方块注册了，但背包里拿不到”的问题，原因通常是：</p>
      <ul class="step-list">
        <li>你只注册了 <code>Block</code>，但没有注册对应的 <code>BlockItem</code>。</li>
        <li>没有把注册类挂到主类的 <code>modEventBus</code> 上（事件总线没注册成功）。</li>
      </ul>

      <h3>为什么需要 BlockItem？</h3>
      <p>在 Minecraft 里，“方块”和“物品”是两套注册表：</p>
      <ul class="step-list">
        <li><code>Block</code>：世界中的方块本体。</li>
        <li><code>Item</code>：背包里能拿到的物品。</li>
      </ul>
      <p>如果你希望玩家能拿到你的方块，就必须给它配套注册一个 <code>BlockItem</code>。</p>

      <h3>本教程采用的注册方式</h3>
      <p>我们在 <code>ModBlocks</code> 里写了一个辅助方法：<code>registerBlockWithItem(...)</code>，它会：</p>
      <ul class="step-list">
        <li>先注册方块到 <code>BLOCKS</code></li>
        <li>再用同一个名字，把 <code>BlockItem</code> 注册到 <code>ModItems.ITEMS</code></li>
      </ul>
      <p>这样做的好处是：你写一个方块时，不用再额外去别的地方“记得补一段方块物品注册”，减少漏写导致的 bug。</p>
      <p>同时也要理解清楚：<strong>方块物品（BlockItem）本质上还是一个 Item</strong>，所以它必须注册在 <code>ITEMS</code> 这个物品注册表里。</p>
      <p class="notice-warning"><strong>提醒：</strong>虽然 <code>BlockItem</code> 是在 <code>ModBlocks</code> 里“顺带注册”的，但它本质上还是属于 <code>ModItems.ITEMS</code>，所以主类里不要忘了同时注册 <code>ModItems</code> 与 <code>ModBlocks</code>。</p>
    </section>

    <section class="section">
      <h2>第三步：创建方块资源文件（blockstates / models / textures）</h2>
      <p>方块资源文件都放在：</p>
      <p><code>src/main/resources/assets/tutorial/</code></p>
      <p>其中关键目录：</p>
      <ul class="step-list">
        <li><code>blockstates/</code>：把“方块状态”映射到“方块模型”。</li>
        <li><code>models/block/</code>：方块模型。</li>
        <li><code>models/item/</code>：方块物品模型（通常直接引用方块模型）。</li>
        <li><code>textures/block/</code>：方块贴图。</li>
      </ul>

      <h3>1) blockstates</h3>
      <p>先在 <code>assets/tutorial/</code> 下新建文件夹：<code>blockstates</code>。</p>
      <p>然后创建：<code>blockstates/crystal_block.json</code>，让方块默认使用模型 <code>tutorial:block/crystal_block</code>。</p>

      <h3>2) models</h3>
      <p>创建：</p>
      <ul class="step-list">
        <li><code>models/block/crystal_block.json</code>：使用 <code>block/cube_all</code>（六面同贴图）。</li>
        <li><code>models/item/crystal_block.json</code>：让物品模型直接继承方块模型。</li>
      </ul>

      <h3>3) textures</h3>
      <p>放入贴图：<code>textures/block/crystal_block.png</code>。</p>
      <p class="notice-warning"><strong>命名提醒：</strong>资源文件名全部小写，并与注册名保持一致（这里统一用 <code>crystal_block</code>）。</p>
    </section>

    <section class="section">
      <h2>第四步：更新语言文件（方块名称）</h2>
      <p>方块的语言 key 规则通常是：</p>
      <pre><code>block.&lt;modid&gt;.&lt;注册名&gt;</code></pre>
      <p>所以本节示例是：</p>
      <pre><code>"block.tutorial.crystal_block": "Crystal Block"</code></pre>
      <p>在 <code>en_us.json</code> 与 <code>zh_cn.json</code> 都要写一份，保证切换语言时都能显示正确。</p>
    </section>

    <section class="section">
      <h2>最后一步：主类里应用注册（别漏）</h2>
      <p>在主类构造方法里确保有：</p>
      <pre><code>ModItems.register(modEventBus);
ModBlocks.register(modEventBus);</code></pre>
      <p>否则会出现：</p>
      <ul class="step-list">
        <li>只注册了方块但没注册方块物品：背包拿不到方块。</li>
        <li>只注册了方块物品但没注册方块：游戏加载时报错。</li>
      </ul>
    </section>

    <section class="section placeholder-section">
      <h2>进游戏验证</h2>
      <p>运行 <code>runClient</code> 进入游戏后，你可以：</p>
      <ul class="step-list">
        <li>在你的自定义物品栏里找到 <code>crystal_block</code>。</li>
        <li>或者直接用指令获取：<code>/give @s tutorial:crystal_block</code></li>
      </ul>
    </section>

    <section class="section">
      <h2>IDE 工程视图（左选文件，右看代码）</h2>
      <p>下面展示你新增/修改的关键文件（已高亮关键行）：</p>

      <div class="viewer-workbench" data-ide-viewer>
        <aside class="viewer-sidebar">
          <p class="viewer-side-title">项目文件</p>
          <div class="viewer-tree"></div>
        </aside>

        <section class="viewer-editor">
          <div class="viewer-topbar">
            <span class="viewer-dot red"></span>
            <span class="viewer-dot amber"></span>
            <span class="viewer-dot green"></span>
            <div class="viewer-tabs" role="tablist" aria-label="打开的文件标签"></div>
            <div class="viewer-search" role="search">
              <input class="viewer-search-input" type="search" placeholder="搜索代码 (Ctrl+F)" aria-label="搜索代码">
              <button class="viewer-search-btn" type="button" data-search-nav="-1" aria-label="上一个搜索结果">↑</button>
              <button class="viewer-search-btn" type="button" data-search-nav="1" aria-label="下一个搜索结果">↓</button>
              <span class="viewer-search-count" aria-live="polite">0 / 0</span>
            </div>
          </div>

          <div class="viewer-code-area">
            <div class="viewer-lines" aria-hidden="true"></div>
            <div class="viewer-code-scroll">
              <div class="viewer-highlight" aria-hidden="true"></div>
              <textarea class="viewer-input" spellcheck="false" readonly aria-label="代码查看器"></textarea>
            </div>
          </div>

          <div class="viewer-status">
            <span class="viewer-path"></span>
          </div>
        </section>

        <script type="text/plain" data-file="src/main/java/com/xiyue/tutorial/common/registry/ModBlocks.java">package com.xiyue.tutorial.common.registry;

import com.xiyue.tutorial.TutorialMod;
import net.minecraft.world.item.BlockItem;
import net.minecraft.world.item.Item;
import net.minecraft.world.level.block.Block;
import net.minecraft.world.level.block.state.BlockBehaviour;
import net.minecraft.world.level.material.MapColor;
import net.minecraftforge.eventbus.api.IEventBus;
import net.minecraftforge.registries.DeferredRegister;
import net.minecraftforge.registries.ForgeRegistries;
import net.minecraftforge.registries.RegistryObject;

import java.util.function.Supplier;

public class ModBlocks {
    public static final DeferredRegister<Block> BLOCKS = DeferredRegister.create(ForgeRegistries.BLOCKS, TutorialMod.MODID);

    public static final RegistryObject<Block> CRYSTAL_BLOCK = registerBlockWithItem("crystal_block",
            () -> new Block(BlockBehaviour.Properties.of().mapColor(MapColor.COLOR_LIGHT_BLUE).strength(1.5F, 3.0F)),
            ModItems.ITEMS
    );

    private static <T extends Block> RegistryObject<T> registerBlock(String name, Supplier<T> supplier) {
        return BLOCKS.register(name, supplier);
    }

    private static <T extends Block> RegistryObject<T> registerBlockWithItem(
            String name,
            Supplier<T> supplier,
            DeferredRegister<Item> items
    ) {
        RegistryObject<T> block = registerBlock(name, supplier);
        items.register(name, () -> new BlockItem(block.get(), new Item.Properties()));
        return block;
    }

    public static void register(IEventBus modEventBus) {
        BLOCKS.register(modEventBus);
    }
}</script>

        <script type="text/plain" data-file="src/main/java/com/xiyue/tutorial/common/registry/ModItems.java">package com.xiyue.tutorial.common.registry;

import com.xiyue.tutorial.TutorialMod;
import net.minecraft.world.item.Item;
import net.minecraftforge.eventbus.api.IEventBus;
import net.minecraftforge.registries.DeferredRegister;
import net.minecraftforge.registries.ForgeRegistries;
import net.minecraftforge.registries.RegistryObject;

public class ModItems {
    public static final DeferredRegister<Item> ITEMS = DeferredRegister.create(ForgeRegistries.ITEMS, TutorialMod.MODID);
    public static final RegistryObject<Item> CRYSTAL = ITEMS.register("crystal", () -> new Item(new Item.Properties()));

    public static void register(IEventBus modEventBus) {
        ITEMS.register(modEventBus);
    }
}</script>

        <script type="text/plain" data-file="src/main/java/com/xiyue/tutorial/TutorialMod.java">package com.xiyue.tutorial;

import com.xiyue.tutorial.common.registry.ModBlocks;
import com.xiyue.tutorial.common.registry.ModCreativeModeTabs;
import com.xiyue.tutorial.common.registry.ModItems;
import net.minecraftforge.eventbus.api.IEventBus;
import net.minecraftforge.fml.config.ModConfig;
import net.minecraftforge.fml.javafmlmod.FMLJavaModLoadingContext;

@Mod(TutorialMod.MODID)
public class TutorialMod {
    public static final String MODID = "tutorial";

    public TutorialMod(FMLJavaModLoadingContext context) {
        IEventBus modEventBus = context.getModEventBus();
        ModItems.register(modEventBus);
        ModBlocks.register(modEventBus);
        ModCreativeModeTabs.register(modEventBus);
        context.registerConfig(ModConfig.Type.COMMON, Config.SPEC);
    }
}</script>

        <script type="text/plain" data-file="src/main/resources/assets/tutorial/blockstates/crystal_block.json">{
  "variants": {
    "": {
      "model": "tutorial:block/crystal_block"
    }
  }
}</script>

        <script type="text/plain" data-file="src/main/resources/assets/tutorial/models/block/crystal_block.json">{
  "parent": "block/cube_all",
  "textures": {
    "all": "tutorial:block/crystal_block"
  }
}</script>

        <script type="text/plain" data-file="src/main/resources/assets/tutorial/models/item/crystal_block.json">{
  "parent": "tutorial:block/crystal_block"
}</script>

        <script type="text/plain" data-file="src/main/resources/assets/tutorial/textures/block/crystal_block.png">[binary png omitted]</script>

        <script type="text/plain" data-file="src/main/resources/assets/tutorial/lang/en_us.json">{
  "item.tutorial.crystal": "Crystal",
  "block.tutorial.crystal_block": "Crystal Block",
  "creativetab.tutorial_tab": "Tutorial"
}</script>

        <script type="text/plain" data-file="src/main/resources/assets/tutorial/lang/zh_cn.json">{
  "item.tutorial.crystal": "水晶",
  "block.tutorial.crystal_block": "水晶块",
  "creativetab.tutorial_tab": "教程"
}</script>
      </div>
    </section>

    <nav class="guide-nav">
      <a href="ch1-sec3-point2-creative-tab.html">上一页</a>
      <a href="chapter-1-intro.html">下一页</a>
    </nav>
  </main>

  <script src="../scripts/main.js"></script>
  <script src="../scripts/ide-viewer.js"></script>
</body>
</html>
